const app=document.querySelector(".app"),timerInput=app.querySelector('[name="timer"]'),breatheInInput=app.querySelector('[name="breatheIn"]'),breatheInAudio=app.querySelector('[data-audio="breathe-in"]'),breatheOutInput=app.querySelector('[name="breatheOut"]'),breatheOutAudio=app.querySelector('[data-audio="breathe-out"]'),signalVolumeInput=app.querySelector('[name="signalVolumeInput"]'),backgroundAudio=app.querySelector('[data-audio="raining-hard"]'),backgroundVolumeInput=app.querySelector('[name="backgroundVolumeInput"]'),startBtn=app.querySelector("button.settings__button_start"),stopBtn=app.querySelector("button.settings__button_stop"),circle=app.querySelector(".cover__animated-circle"),circleText=app.querySelector(".cover__animated-text"),message=app.querySelector(".settings__message");let meditateTimer,meditateInterval;HTMLAudioElement.prototype.stop=function(){this.pause(),this.currentTime=0},startBtn.addEventListener("click",()=>{core.time.timer=+timerInput.value,core.time.breatheIn=+breatheInInput.value,core.time.breatheOut=+breatheOutInput.value,meditate()}),stopBtn.addEventListener("click",()=>{stopMeditate()}),signalVolumeInput.addEventListener("change",()=>{breatheInAudio.volume=signalVolumeInput.value/100,breatheOutAudio.volume=signalVolumeInput.value/100}),backgroundVolumeInput.addEventListener("change",()=>{backgroundAudio.volume=backgroundVolumeInput.value/100});const core={isMeditate:!1,circleText:{waiting:"Ожидание",breatheIn:"Вдох",breatheOut:"Выдох"},time:{timer:0,breatheIn:0,breatheOut:0},message:{good:"",bad:"Ошибка! Проверьте правильно ли заполнены поля выше"}};function meditate(){0===core.time.timer||0===core.time.breatheIn||0===core.time.breatheOut||core.time.timer<1||core.time.breatheIn<4||core.time.breatheOut<4?message.innerText=core.message.bad:([timerInput,breatheInInput,breatheOutInput,startBtn].forEach(e=>e.setAttribute("disabled","disabled")),core.isMeditate=!0,message.innerText=core.message.good,backgroundAudio.play(),makeBreatheCycle(),meditateInterval=setInterval(()=>{core.isMeditate&&makeBreatheCycle()},1e3*core.time.breatheIn+1e3*core.time.breatheOut),meditateTimer=setTimeout(stopMeditate,60*core.time.timer*1e3))}function makeBreatheCycle(){makeBreatheIn(),setTimeout(()=>{core.isMeditate&&makeBreatheOut()},1e3*core.time.breatheIn)}function makeBreatheIn(){circleText.innerText=core.circleText.breatheIn,breatheInAudio.play(),circle.style.cssText=`\n        transform: scale(1.4);\n        transition: ${core.time.breatheIn}s;\n    `}function makeBreatheOut(){circleText.innerText=core.circleText.breatheOut,breatheOutAudio.play(),circle.style.cssText=`\n        transform: scale(1);\n        transition: ${core.time.breatheOut}s;\n    `}function stopMeditate(){core.isMeditate=!1,circleText.innerText=core.circleText.waiting,[timerInput,breatheInInput,breatheOutInput,startBtn].forEach(e=>e.removeAttribute("disabled")),[breatheInAudio,breatheOutAudio,backgroundAudio].forEach(e=>e.stop()),clearTimeout(meditateTimer),clearInterval(meditateInterval),circle.style.cssText="\n        transform: scale(1);\n        transition: .5s;\n    "}